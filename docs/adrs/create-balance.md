# ADR

# Demo-счёт

## Статус

Предложение

## Контекст

Отправка инвестором запроса на получение информации по своему счёту.

Пополнение Счета Инвестора.

## Решение

Добавить логин в запросы, чтобы работать с данными конкретного инвестора.

Вывод данных по счёту - только сумма.

Архитектура
Создание микросервиса баланса с использованием шаблонов.
[Identity и простой шаблоны](https://github.com/Calabonga/Microservice-Template/tree/master/AspNetCore%20v6.0/MinimalAPI)

--Отправка инвестором запроса на получение информации по своему счёту.--
Фасад отправляет сообщение в кафку (топик "balance"). Микросервис баланса получает команду и ищет данные по логину, после чего происходит отправка данных о его балансе в кафку, фасад из кафки получает данные и перекидывает их клиенту.
--Пополнение Счета Инвестора.
Фасад отправляет сообщение {token, сумма_пополнения} в кафку (топик "replenishment").
Микросервис баланса получается команду и ищет логин инвестора, если нет в таблице информации о балансе, то вносится новая запись с данной суммой, если же есть информация, то происходит update. Далее отправляется информация об общей сумме инвестора на счету в кафку. После чего возвращается ответ на клиент.

## Последствия

Не нужно будет работать со всеми данными из бд, а только с данными конкретного инвестора.

Простое получение нужной информации.
